<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventory Management</title>
  <link rel="stylesheet" href="../Styles/inventory.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background-color: #F5F6FA; color: #2D3436; }
    html { scroll-behavior: smooth; }

    /* Layout */
    .navbar { position: fixed; top: 0; left: 270px; right: 0; height: 70px; background: #6A3C3E; color: white; display: flex; justify-content: flex-end; align-items: center; padding: 0 40px; z-index: 100; }
    .logo { font-weight: 500; font-size: 16px; }

    .sidebar { position: fixed; top: 0; left: 0; width: 270px; height: 100vh; background: white; box-shadow: 2px 0 15px rgba(0,0,0,0.08); padding-top: 20px; z-index: 200; }
    .profile { padding: 30px 20px; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid #eee; }
    .profile-pic { width: 50px; height: 50px; border-radius: 50%; border: 3px solid #1ABC9C; object-fit: cover; }
    .sidebar a { display: block; padding: 16px 25px; color: #636E72; text-decoration: none; font-weight: 500; transition: all 0.3s; }
    .sidebar a:hover { background: #f8f9fa; color: #A45A5A; padding-left: 30px; }
    .sidebar a.active { background: #A45A5A; color: white; font-weight: 600; }

    .content { margin-left: 270px; margin-top: 70px; padding: 40px; min-height: calc(100vh - 70px); }
    h2 { font-size: 32px; font-weight: 700; margin-bottom: 8px; }
    p { color: #636E72; margin-bottom: 30px; }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }
    .stat-card {
      background: white;
      padding: 28px;
      border-radius: 16px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.06);
    }
    .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .stat-header span { font-size: 14px; color: #636E72; }
    .stat-icon { width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    .stat-number { font-size: 48px; font-weight: 700; color: #2D3436; }

    /* Search & Filter */
    .search-container {
      margin-bottom: 30px;
    }
    .search-container select {
      padding: 12px 20px;
      border: 1px solid #DFE6E9;
      border-radius: 10px;
      background: white;
      font-size: 15px;
      cursor: pointer;
      min-width: 200px;
    }

    /* Table */
    .table-container {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.06);
      margin-top: 40px;
    }
    table { width: 100%; border-collapse: collapse; }
    thead { background: #ffffff; }
    th { padding: 20px 24px; text-align: left; font-weight: 600; color: #6A3C3E; font-size: 14px; text-transform: uppercase; }
    td { padding: 18px 24px; font-size: 15px; border-bottom: 1px solid #eee; }
    tbody tr:hover { background: #f8f9fa; }

    .viewBtn, .deleteBtn {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
    }
    .viewBtn { background: #1a4971; color: white; }
    .deleteBtn { background: #e74c3c; color: white; margin-left: 8px; }

    /* Modals */
    .modal-overlay, .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(5px);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    .modal-header {
      background: #1a4971;
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .close-modal { font-size: 28px; cursor: pointer; }
    .modal-body { padding: 30px; }
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #eee;
    }
    .detail-row:last-child { border: none; }
    .item-image { width: 120px; height: 120px; object-fit: cover; border-radius: 8px; border: 2px solid #ddd; }

    .modal-footer { padding: 20px; text-align: right; background: #f9f9f9; }
    .close-btn { padding: 10px 24px; background: #1a4971; color: white; border: none; border-radius: 8px; cursor: pointer; }

    /* Delete Modal */
    .modal.small .modal-content { max-width: 400px; text-align: center;}
    .modal-buttons { 
      display: flex; 
      justify-content: center; 
      gap: 15px; 
      margin-top: 20px;
      align-items: center; 
    }
    
    #cancelDelete { padding: 10px 24px; background: #ddd; border: none; border-radius: 8px; cursor: pointer; }
    #confirmDelete { padding: 10px 24px; background: #e74c3c; color: white; border: none; border-radius: 8px; cursor: pointer; }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="logo">Welcome back, Admin!</div>
  </nav>

  <div class="sidebar">
    <div class="profile">
      <img src="../assest/profile.png" alt="" class="profile-pic" />
      <h3>D’jackman Tailor Deluxe</h3>
    </div>
    <a href="admin.html">Dashboard</a>
    <a href="appointments.html">Appointments</a>
    <a href="customization.html">Customization</a>
    <a href="drycleaning.html">Dry Cleaning</a>
    <a href="rental.html">Rentals</a>
    <a href="AddRent.html">Post Rent</a>
    <a href="repairs.html">Repairs</a>
    <a href="inventory.html" class="active">Inventory</a>
  </div>

  <div class="content">
    <h2>Completed Orders History</h2>
    <p>View all completed services across Customization, Dry Cleaning, Rentals, and Repairs</p>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <span>Completed Customization</span>
          <div class="stat-icon" style="background: #e8f5e9; color: #4caf50;">✓</div>
        </div>
        <div class="stat-number" id="customCount">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-header">
          <span>Completed Dry Cleaning</span>
          <div class="stat-icon" style="background: #e8f5e9; color: #4caf50;">✓</div>
        </div>
        <div class="stat-number" id="cleaningCount">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-header">
          <span>Returned Rentals</span>
          <div class="stat-icon" style="background: #e8f5e9; color: #4caf50;">✓</div>
        </div>
        <div class="stat-number" id="rentalCount">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-header">
          <span>Completed Repairs</span>
          <div class="stat-icon" style="background: #e8f5e9; color: #4caf50;">✓</div>
        </div>
        <div class="stat-number" id="repairCount">0</div>
      </div>
    </div>

    <div class="search-container">
      <select id="filter">
        <option value="">All Services</option>
        <option value="Customization">Customization</option>
        <option value="Dry Cleaning">Dry Cleaning</option>
        <option value="Rentals">Rentals</option>
        <option value="Repairs">Repairs</option>
      </select>
    </div>

    <div class="table-container">
      <table class="inventory-table">
        <thead>
          <tr>
            <th>Unique No.</th>
            <th>Customer</th>
            <th>Service Type</th>
            <th>Item</th>
            <th>Date Completed</th>
            <th>Price</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="inventoryBody">
          <!-- Filled by JS -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- View Details Modal -->
  <div id="detailModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Order Details</h2>
        <span class="close-modal">×</span>
      </div>
      <div class="modal-body">
        <div class="detail-row"><strong>Unique No:</strong> <span id="modalUniqueNo"></span></div>
        <div class="detail-row"><strong>Customer:</strong> <span id="modalCustomer"></span></div>
        <div class="detail-row"><strong>Service:</strong> <span id="modalService"></span></div>
        <div class="detail-row"><strong>Item:</strong> <span id="modalItem"></span></div>
        <div class="detail-row"><strong>Date Completed:</strong> <span id="modalDate"></span></div>
        <div class="detail-row"><strong>Price:</strong> <span id="modalPrice" style="color:#2e7d32; font-weight:bold;"></span></div>
      </div>
      <div class="modal-footer">
        <button class="close-btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal">
    <div class="modal-content small">
      <h3>Delete Order?</h3>
      <p>This completed order will be permanently removed from records.</p>
      <div class="modal-buttons">
        <button id="cancelDelete">Cancel</button>
        <button id="confirmDelete">Delete</button>
      </div>
    </div>
  </div>

  <script>
    // Combined completed orders from all services
    const completedOrders = [
      { id: 1, uniqueNo: "C223111", customer: "Maria Santos", service: "Customization", item: "Barong Tagalog", date: "2024-11-15", price: 4500 },
      { id: 2, uniqueNo: "DC244222", customer: "Ben Lim", service: "Dry Cleaning", item: "Wedding Gown", date: "2024-11-18", price: 1800 },
      { id: 3, uniqueNo: "R333555", customer: "Sofia Reyes", service: "Rentals", item: "Black Suit", date: "2024-11-10", price: 3500 },
      { id: 4, uniqueNo: "RP444666", customer: "Carlos Tan", service: "Repairs", item: "Leather Jacket", date: "2024-11-12", price: 2800 },
      { id: 5, uniqueNo: "C555777", customer: "Anna Cruz", service: "Customization", item: "Formal Dress", date: "2024-11-19", price: 6200 },
      { id: 6, uniqueNo: "DC666888", customer: "Mark Santos", service: "Dry Cleaning", item: "Blazer & Pants", date: "2024-11-17", price: 1500 }
    ];

    let currentDeleteId = null;

    function updateStats() {
      const counts = {
        Customization: completedOrders.filter(o => o.service === "Customization").length,
        "Dry Cleaning": completedOrders.filter(o => o.service === "Dry Cleaning").length,
        Rentals: completedOrders.filter(o => o.service === "Rentals").length,
        Repairs: completedOrders.filter(o => o.service === "Repairs").length
      };
      document.getElementById("customCount").textContent = counts.Customization;
      document.getElementById("cleaningCount").textContent = counts["Dry Cleaning"];
      document.getElementById("rentalCount").textContent = counts.Rentals;
      document.getElementById("repairCount").textContent = counts.Repairs;
    }

    function populateTable(orders = completedOrders) {
      const tbody = document.getElementById("inventoryBody");
      tbody.innerHTML = "";

      if (orders.length === 0) {
        tbody.innerHTML = `<tr><td colspan="7" style="text-align:center; padding:40px; color:#888;">No completed orders found</td></tr>`;
        return;
      }

      orders.forEach(order => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><strong>${order.uniqueNo}</strong></td>
          <td>${order.customer}</td>
          <td><span style="padding:6px 12px; border-radius:6px; font-size:12px; font-weight:600; 
            background:${order.service === 'Customization' ? '#e3f2fd' : 
                        order.service === 'Dry Cleaning' ? '#e8f5e9' : 
                        order.service === 'Rentals' ? '#fff3e0' : '#ffebee'};
            color:${order.service === 'Customization' ? '#1976d2' : 
                   order.service === 'Dry Cleaning' ? '#2e7d32' : 
                   order.service === 'Rentals' ? '#f57c00' : '#d32f2f'}">
            ${order.service}</span></td>
          <td>${order.item}</td>
          <td>${order.date}</td>
          <td>₱${order.price.toLocaleString()}</td>
          <td>
            <button class="viewBtn" onclick="viewOrder(${order.id})">View</button>
            <button class="deleteBtn" onclick="confirmDelete(${order.id})">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function viewOrder(id) {
      const order = completedOrders.find(o => o.id === id);
      if (!order) return;

      document.getElementById("modalUniqueNo").textContent = order.uniqueNo;
      document.getElementById("modalCustomer").textContent = order.customer;
      document.getElementById("modalService").textContent = order.service;
      document.getElementById("modalItem").textContent = order.item;
      document.getElementById("modalDate").textContent = order.date;
      document.getElementById("modalPrice").textContent = `₱${order.price.toLocaleString()}`;

      document.getElementById("detailModal").style.display = "flex";
    }

    function confirmDelete(id) {
      currentDeleteId = id;
      document.getElementById("deleteModal").style.display = "flex";
    }

    // Event Listeners
    document.getElementById("filter").addEventListener("change", function() {
      const filter = this.value;
      const filtered = filter ? completedOrders.filter(o => o.service === filter) : completedOrders;
      populateTable(filtered);
    });

    document.getElementById("cancelDelete").onclick = () => {
      document.getElementById("deleteModal").style.display = "none";
    };

    document.getElementById("confirmDelete").onclick = () => {
      completedOrders = completedOrders.filter(o => o.id !== currentDeleteId);
      document.getElementById("deleteModal").style.display = "none";
      alert("Order deleted permanently.");
      updateStats();
      populateTable();
    };

    // Close modals
    document.querySelectorAll(".close-modal, .close-btn").forEach(el => {
      el.onclick = () => {
        document.getElementById("detailModal").style.display = "none";
      };
    });

    window.onclick = (e) => {
      if (e.target.classList.contains("modal-overlay") || e.target.classList.contains("modal")) {
        e.target.style.display = "none";
      }
    };

    // Initialize
    document.addEventListener("DOMContentLoaded", () => {
      updateStats();
      populateTable();
    });
  </script>
</body>
</html>