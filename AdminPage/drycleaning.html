<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dry Cleaning Management</title>
  <link rel="stylesheet" href="../Styles/Admincleaning.css">
  <style>

    .add-rep {
      display: inline-block; padding: 14px 30px; background: #6A3C3E; color: white;
      border: none; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 600;
      box-shadow: 0 4px 15px rgba(106,60,62,0.3);
    }
    .add-rep:hover { background: #552f30; transform: translateY(-2px); }

    /* Status Select */
    .status-select { padding: 8px 14px; border: 1px solid #ccc; border-radius: 8px; font-weight: 600; min-width: 140px; cursor: pointer; }
    .status-select.in-progress { background: #e3f2fd; color: #1976d2; }
    .status-select.to-pickup { background: #fff3e0; color: #f57c00; }
    .status-select.completed { background: #e8f5e9; color: #388e3c; }
    .status-select.overdue { background: #ffebee; color: #d32f2f; }

    .action-btn { padding: 8px 16px; background: #2196f3; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; }

    /* MODAL STYLES */
    .modal-overlay {
      display: none;
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.65); backdrop-filter: blur(10px);
      z-index: 1000; justify-content: center; align-items: center; padding: 20px;
    }
    .modal-overlay.active { display: flex; }

    .modal-content {
      background: white; width: 100%; max-width: 580px; border-radius: 18px;
      box-shadow: 0 25px 70px rgba(0,0,0,0.3); overflow: hidden;
    }
    .modal-header {
      background: #6A3C3E; color: white; padding: 22px 30px;
      display: flex; justify-content: space-between; align-items: center;
    }
    .modal-header h2 { margin: 0; font-size: 1.6rem; font-weight: 600; }
    .close-modal {
      font-size: 32px; cursor: pointer; width: 44px; height: 44px;
      display: flex; align-items: center; justify-content: center; border-radius: 50%;
    }
    .close-modal:hover { background: rgba(255,255,255,0.2); }

    .modal-body { padding: 35px 30px; }
    .form-group { margin-bottom: 22px; }
    .form-group label { display: block; margin-bottom: 10px; font-weight: 600; color: #333; }
    .form-group input, .form-group select {
      width: 100%; padding: 16px; border: 2px solid #ddd; border-radius: 12px;
      font-size: 16px; transition: all 0.3s;
    }
    .form-group input:focus, .form-group select:focus {
      outline: none; border-color: #6A3C3E; box-shadow: 0 0 0 4px rgba(106,60,62,0.15);
    }

    .modal-footer {
      padding: 20px 30px; background: #f8f9fa; text-align: right; border-top: 1px solid #eee;
    }
    .btn-save {
      padding: 14px 40px; background: #6A3C3E; color: white; border: none;
      border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer;
    }
    .btn-save:hover { background: #552f30; }

    .status-badge { padding: 8px 16px; border-radius: 20px; font-weight: 600; font-size: 0.9rem; }
    .status-badge.in-progress { background: #e3f2fd; color: #1976d2; }
    .status-badge.to-pickup { background: #fff3e0; color: #f57c00; }
    .status-badge.completed { background: #e8f5e9; color: #2e7d32; }
    .status-badge.overdue { background: #ffebee; color: #d32f2f; }

        /* Modal Overlay */
.Modal-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(5px);
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
  animation: fadeIn 0.3s ease;
}

/* Modal Content Box */
.Modal-content {
  background: white;
  width: 100%;
  max-width: 500px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  overflow: hidden;
  animation: slideUp 0.4s ease;
}

/* Header */
.Modal-header {
  background: #6A3C3E;
  color: white;
  padding: 16px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 1.4rem;
}

.Modal-header h2 {
  margin: 0;
  font-size: 1.4rem;
}

.Close-modal {
  font-size: 28px;
  cursor: pointer;
  font-weight: bold;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.2s;
}

.Close-modal:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* Body */
.Modal-body {
  padding: 24px;
}

.detail-row {
  display: flex;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid #eee;
  font-size: 1rem;
}

.detail-row:last-child {
  border-bottom: none;
}

.detail-row strong {
  color: #333;
  min-width: 140px;
}

  </style>
</head>
<body>

  <nav class="navbar"><div class="logo">Welcome back, Admin!</div></nav>

  <div class="sidebar">
    <div class="profile">
      <img src="../assest/profile.png" alt="" class="profile-pic">
      <h3>Dâ€™jackman Tailor Deluxe</h3>
    </div>
    <a href="admin.html">Dashboard</a>
    <a href="appointments.html">Appointments</a>
    <a href="customization.html">Customization</a>
    <a href="drycleaning.html" class="active">Dry Cleaning</a>
    <a href="rental.html">Rentals</a>
    <a href="AddRent.html">Post Rent</a>
    <a href="repairs.html">Repairs</a>
    <a href="orders.html">Inventory</a>
  </div>

  <div class="content">
    <div class="dashboard-title">
      <h2>Dry Cleaning Management</h2>
      <p>Track and manage all dry cleaning orders</p>
      <div class="add-rep" onclick="openAddModal()">Add Order +</div>
    </div>

    
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <span>In Progress</span>
          <div class="stat-icon" style="background: #e3f2fd; color: #2196f3;">ðŸ”„</div>
        </div>
        <div class="stat-number" id="inProgressCount">0</div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span>To Pick up</span>
          <div class="stat-icon" style="background: #fff3e0; color: #ff9800;">ðŸ“¦</div>
        </div>
        <div class="stat-number" id="toPickupCount">0</div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span>Completed</span>
          <div class="stat-icon" style="background: #e8f5e9; color: #4caf50;">âœ“</div>
        </div>
        <div class="stat-number" id="completedCount">0</div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span>Overdue</span>
          <div class="stat-icon" style="background: #ffebee; color: #f44336;">âš </div>
        </div>
        <div class="stat-number" id="overdueCount">0</div>
      </div>
    </div>

    <div class="search-container">
      <input type="text" placeholder="Search by Unique No." id="searchUniqueNum">
      <select id="statusFilter">
        <option value="">All Status</option>
        <option value="In Progress">In Progress</option>
        <option value="To Pick up">To Pick up</option>
        <option value="Completed">Completed</option>
        <option value="Overdue">Overdue</option>
      </select>
    </div>
  </div>

  <div class="container">
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Unique No.</th>
            <th>Name</th>
            <th>Garment</th>
            <th>Date</th>
            <th>Price</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="content"></tbody>
      </table>
    </div>
  </div>

  <!-- ADD ORDER MODAL -->
  <div class="modal-overlay" id="addModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Add New Order</h2>
        <span class="close-modal" onclick="closeAddModal()">x</span>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Customer Name</label>
          <input type="text" id="newName" placeholder="e.g. Maria Santos">
        </div>
        <div class="form-group">
          <label>Garment</label>
          <input type="text" id="newGarment" placeholder="e.g. Wedding Gown">
        </div>
        <div class="form-group">
          <label>Price (â‚±)</label>
          <input type="number" id="newPrice" placeholder="e.g. 1800" min="1">
        </div>
        <div class="form-group">
          <label>Status</label>
          <select id="newStatus">
            <option value="In Progress">In Progress</option>
            <option value="To Pick up">To Pick up</option>
            <option value="Completed">Completed</option>
            <option value="Overdue">Overdue</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-save" onclick="saveNewOrder()">Add Order</button>
      </div>
    </div>
  </div>

  <!-- VIEW DETAILS MODAL -->
  <div class="modal-overlay" id="detailModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Order Details</h2>
        <span class="close-modal">x</span>
      </div>
      <div class="modal-body">
        <div class="detail-row"><strong>Unique No:</strong> <span id="modalUniqueNo"></span></div>
        <div class="detail-row"><strong>Customer:</strong> <span id="modalCustomerName"></span></div>
        <div class="detail-row"><strong>Garment:</strong> <span id="modalGarment"></span></div>
        <div class="detail-row"><strong>Date:</strong> <span id="modalDate"></span></div>
        <div class="detail-row"><strong>Price:</strong> <span id="modalPrice" style="color:#2e7d32;font-weight:bold;"></span></div>
        <div class="detail-row"><strong>Status:</strong> <span id="modalStatus" class="status-badge"></span></div>
      </div>
      <div class="modal-footer">
        <button class="btn-save" style="background:#666;" onclick="document.getElementById('detailModal').classList.remove('active')">Close</button>
      </div>
    </div>

  <script>
    // Load from localStorage or use mock data
    let orders = JSON.parse(localStorage.getItem('dryCleaningOrders')) || [
      { id: 1, uniqueNo: "D223111", name: "Maria Santos", garment: "Barong Tagalog", date: "2025-04-10", price: 950, status: "In Progress" },
      { id: 2, uniqueNo: "D223112", name: "Juan Cruz", garment: "Wedding Gown", date: "2025-04-08", price: 2500, status: "To Pick up" },
      { id: 3, uniqueNo: "D223113", name: "Lina Reyes", garment: "Suit", date: "2025-04-05", price: 1800, status: "Completed" },
      { id: 4, uniqueNo: "D223114", name: "Carlos Lim", garment: "Dress", date: "2025-03-30", price: 1200, status: "Overdue" },
      { id: 5, uniqueNo: "D223115", name: "Anna Tan", garment: "Blazer", date: "2025-04-09", price: 1600, status: "In Progress" }
    ];

    function generateUniqueNo() {
      return 'D' + Date.now().toString().slice(-6);
    }

    function updateStats() {
      document.getElementById('inProgressCount').textContent = orders.filter(o => o.status === 'In Progress').length;
      document.getElementById('toPickupCount').textContent = orders.filter(o => o.status === 'To Pick up').length;
      document.getElementById('completedCount').textContent = orders.filter(o => o.status === 'Completed').length;
      document.getElementById('overdueCount').textContent = orders.filter(o => o.status === 'Overdue').length;
    }

    function populateTable(filtered = orders) {
      const tbody = document.getElementById('content');
      tbody.innerHTML = filtered.length === 0 
        ? `<tr><td colspan="7" style="text-align:center; padding:60px; color:#888;">No orders found</td></tr>`
        : '';

      filtered.forEach(order => {
        const statusClass = order.status.toLowerCase().replace(' ', '-');
        const selectHTML = `<select class="status-select ${statusClass}" onchange="updateStatus(${order.id}, this.value)">
          ${['In Progress','To Pick up','Completed','Overdue'].map(s => 
            `<option value="${s}" ${s===order.status?'selected':''}>${s}</option>`
          ).join('')}
        </select>`;

        tbody.innerHTML += `
          <tr>
            <td><strong>${order.uniqueNo}</strong></td>
            <td>${order.name}</td>
            <td>${order.garment}</td>
            <td>${order.date}</td>
            <td>â‚±${order.price.toLocaleString()}</td>
            <td>${selectHTML}</td>
            <td><button class="action-btn" onclick="viewDetails(${order.id})">View</button></td>
          </tr>
        `;
      });
      updateStats();
    }

    function updateStatus(id, newStatus) {
      const order = orders.find(o => o.id === id);
      if (order) {
        order.status = newStatus;
        localStorage.setItem('dryCleaningOrders', JSON.stringify(orders));
        populateTable();
      }
    }

    function viewDetails(id) {
      const order = orders.find(o => o.id === id);
      if (!order) return;

      document.getElementById('modalUniqueNo').textContent = order.uniqueNo;
      document.getElementById('modalCustomerName').textContent = order.name;
      document.getElementById('modalGarment').textContent = order.garment;
      document.getElementById('modalDate').textContent = order.date;
      document.getElementById('modalPrice').textContent = `â‚±${order.price.toLocaleString()}`;

      const badge = document.getElementById('modalStatus');
      badge.textContent = order.status;
      badge.className = 'status-badge ' + order.status.toLowerCase().replace(' ', '-');

      document.getElementById('detailModal').classList.add('active');
    }

    // Add Order Modal
    function openAddModal() {
      document.getElementById('newName').value = '';
      document.getElementById('newGarment').value = '';
      document.getElementById('newPrice').value = '';
      document.getElementById('newStatus').value = 'In Progress';
      document.getElementById('addModal').classList.add('active');
    }

    function closeAddModal() {
      document.getElementById('addModal').classList.remove('active');
    }

    function saveNewOrder() {
      const name = document.getElementById('newName').value.trim();
      const garment = document.getElementById('newGarment').value.trim();
      const price = parseFloat(document.getElementById('newPrice').value);

      if (!name || !garment || !price || price <= 0) {
        alert('Please fill all fields correctly.');
        return;
      }

      const newOrder = {
        id: Date.now(),
        uniqueNo: generateUniqueNo(),
        name, garment,
        date: new Date().toISOString().split('T')[0],
        price, status: document.getElementById('newStatus').value
      };

      orders.push(newOrder);
      localStorage.setItem('dryCleaningOrders', JSON.stringify(orders));
      closeAddModal();
      populateTable();
      alert('Order added successfully!');
    }

    // Search & Filter
    function applyFilters() {
      const search = document.getElementById('searchUniqueNum').value.toLowerCase();
      const status = document.getElementById('statusFilter').value;
      const filtered = orders.filter(o =>
        (o.uniqueNo.toLowerCase().includes(search) || o.name.toLowerCase().includes(search)) &&
        (!status || o.status === status)
      );
      populateTable(filtered);
    }

    document.getElementById('searchUniqueNum').addEventListener('input', applyFilters);
    document.getElementById('statusFilter').addEventListener('change', applyFilters);

    // Close modals on outside click
    document.addEventListener('click', e => {
      if (e.target.classList.contains('modal-overlay') || e.target.classList.contains('close-modal')) {
        document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
      }
    });

    // Initialize â€” Mock data shows immediately
    document.addEventListener('DOMContentLoaded', () => {
      populateTable();
    });
  </script>
</body>
</html>